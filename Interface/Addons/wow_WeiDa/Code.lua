local data=[[
将萨尔当做奴隶关押在敦霍尔德城堡的人类叫什么名字？ A. 奥里登·匹瑞诺德 B. 加林·托尔贝恩 C. 达瓦尔·普瑞斯托 !D. 埃德拉斯·布莱克摩尔
喝下诺格弗格药剂后不可能出现以下哪种后果？ A. 缩小 B. 变成骷髅 C. 获得缓落术效果 !D. 喷火
在屈服于魔瘾之前，失心者曾属于哪个种族？ !A. 血精灵 B. 人类 C. 暗夜精灵 D. 被遗忘者
以下哪种潘达利亚生物是包括猜忌、绝望和愤怒在内的各类负面情绪的化身？ A. 螳螂妖 B. 兔妖 C. 猢狲 !D. 煞魔
在情人节期间，以下哪位药剂师不可能出现在影牙城堡？ A. 弗莱伊 C. 拜克斯特 !B. 科普兰 D. 汉摩尔
在巨魔的赞达拉语中，“atal’ai”是什么意思？ A. 虔诚者 B. 受眷顾者 C. 选民 !D. 忠诚者
环绕时光之穴的沙漠叫做？ A. 奥丹姆 !B. 塔纳利斯 C. 希利苏斯 D. 凄凉之地
哪种乐器可以让别人不由自主地翩翩起舞？ !A. 烈焰短笛 B. 凤凰王的金曦琴 C. 寄魂战鼓 D. 上古长笛
以下哪位深渊领主在被伊利丹·怒风囚禁前曾经统治过外域？ A. 阿兹加洛 B. 布鲁塔卢斯 C. 玛诺洛斯 !D. 玛瑟里顿
死亡之翼归来时，摧毁了位于黑海岸的哪座联盟城市？ A. 洛达内尔 B. 亚米萨兰 !C. 奥伯丁 D. 古树之林
以下哪位不是最初创立白银之手的五位圣骑士之一？ A. 乌瑟尔 !B. 亚历山德罗斯 C. 格文拉德 D. 赛丹
帮助萨尔逃离敦霍尔德城堡的人类叫什么名字？ A. 克拉米·朗斯顿 B. 阿尔萨斯·米奈希尔 C. 吉安娜·普罗德摩尔 !D. 特蕾莎·福克斯顿
祖尔金在被俘并逃脱的过程中失去了哪只手和哪只眼？ !A. 右眼，左臂 B. 左眼，左臂 C. 右眼，右臂 D. 左眼，右臂
无头骑士的名言：“湮远而艰辛的探索到此为止……”的下半句是？ A. “真正的强者将由命运择示！”  B. “真正的正当者将由命运择示！”  !C. “真正的正义者将由命运择示！”  D. “真正的愉悦者将由命运择示！”
连接阿拉希高地和湿地的大桥叫什么名字？ A. 断桥 B. 晨之桥 C. 萨弗隆大桥 !D. 萨多尔大桥
下面哪个是伊利丹的纳迦副官以及艾萨拉女王的前侍女？ A. 纳兹夏尔 !B. 瓦斯琪 C. 扎哈拉 D. 瓦丽丝琪
在德莱尼语中，下面哪句话是“一路平安”的意思？ A. Achal hecta !B. Dioniss aca C. Acheon kor D. Heckt corta
以仁慈著称，却支持了死亡之翼的前暴风城精神领袖叫什么名字？ !A. 本尼迪塔斯 B. 纯洁的凯瑟琳 C. 格雷森·沙东布瑞克 D. 虔诚的亚瑟
克鲁·粗线持续威胁到了沙塔斯城中的哪一类商人？ A. 背包商人 !B. 水果商人 C. 材料商人 D. 武器商人
以下哪个兽人在德拉诺打开了无数传送门并撕裂了兽人的故乡？ A. 耐奥祖 !B. 古尔丹 C. 斯卡塔克斯 D. 格里弗
达拉然最早位于东部王国的哪里？ A. 阿拉希高地 B. 银松森林 !C. 希尔斯布莱德丘陵 D. 提瑞斯法林地
第一个骑着海龟神真子离开潘达利亚的熊猫人是谁？ A. 少昊 B. 辛慈 C. 丽丽·风暴烈酒 !D. 刘浪
血羽、风怒和巫翼都是哪个种族的生物？ !A. 鹰身人 B. 鸦人 C. 卡利鸟 D. 角鹰兽
以下哪个教派受过兽人暗影议会的影响，并有纳伽兹和玛雷兹·考尔这样的信徒？ A. 火刃氏族 B. 萨格雷 !C. 阿古斯的觉醒 D. 秘教徒
萨鲁法尔的兄弟，唯一打过上古之战的兽人叫什么名字？ !A. 布洛克斯加 B. 伊崔格 C. 德拉诺什·萨鲁法尔 D. 德雷克塔尔
探险者大厅中展览的红龙头骨是属于谁的？ A. 瓦拉斯塔兹 B. 阿弗拉沙斯塔兹 C. 凯雷斯特拉兹 !D. 泰拉纳斯塔兹
地精将以下哪片区域改造成了部落标志的形状？ !A. 艾萨拉 B. 科赞 C. 杜隆塔尔 D. 莫高雷
以下哪位成为了拉格纳罗斯的第二位管理者，看守着火焰之地的萨弗隆城堡？ !A. 管理者鹿盔 B. 管理者埃克索图斯 C. 管理者贝丝缇拉克 D. 管理者沙恩诺克斯
钢鬃和刺背是哪个种族的两大对立部族？ !A. 野猪人 B. 豺狼人 C. 刃牙虎人 D. 鹰身人
土地精最珍视的私人财产是什么？ A. 背包 B. 牦牛 !C. 幸运符 D. 霉运符
维克多•奈法里奥斯勋爵是以下哪条巨龙的人类伪装？ A. 萨贝里安 B. 伊萨里奥斯 !C. 奈法利安 D. 萨菲隆
一位联盟叛徒的儿子日后成长为了辛迪加的首领，他叫什么名字？ A. 伊瑟顿 B. 艾登 C. 埃德拉斯 !D. 奥里登
以下哪个不是兽人部族？ A. 霜狼 B. 战歌 !C. 血牙 D. 龙喉
在大灾变之前，我们可以在哪里找到曼科里克妻子的遗体？ A. 千针石林 B. 杜隆塔尔 C. 莫高雷 !D. 贫瘠之地
哈克娅的配偶叫什么名字？ !A. 洛卡纳哈 B. 西瓦尔拉 C. 马格瑞亚 D. 安卡
暗夜精灵看守者的最高层叫什么？ A. 游侠将军 B. 守护者 !C. 守望者 D. 哨兵
以下哪个地精贸易公司以掠夺艾泽拉斯的自然资源而著称？ A. 黑水强盗 !B. 风险投资公司 C. 卡亚罗贸易公司 D. 烟林牧场
克鲁什、摩什和爵德都是什么类型的生物？ A. 猩猩 !B. 暴龙 C. 巨人 D. 食人魔
吉安娜在肯瑞托的导师是谁？ !A. 大法师安东尼达斯 B. 大法师卡德加 C. 大法师茉德拉 D. 大法师克尔苏加德
暗夜精灵与巨龙军团曾在哪场战争中并肩对抗其拉虫族的大军？ A. 上古之战 B. 萨特之战 !C. 流沙之战 D. 蜘蛛之战
第一个驯养云端翔龙的熊猫人叫什么名字？ !A. 蒋 B. 苏琪 C. 安离 D. 杜同
阿尔萨斯被击败后，谁成为了巫妖王？ A. 提里奥·弗丁 !B. 伯瓦尔·弗塔根 C. 达里安·莫格莱尼 D. 泰瑞纳斯·米奈希尔二世
看守伊利丹·怒风的狱卒是以下哪位暗夜精灵？ A. 加洛德·影歌  B. 玛法里奥·怒风 !C. 玛维·影歌 D. 卡利菲克司

告诉我，英雄，亡灵鱼人被称作什么？ A. 鳄鱼人 !B. 行尸鱼人 C. 狼獾人 D. 巫妖鱼人
下列哪句话是龙语中“谢谢你”的意思？ A. Borela mir !B. Belan shi C. Avral shi D. Alena mir
下列哪一位的墓志铭上刻有“愿血染的王冠永远被遗失和忘却”这句话？ A. 阿尔萨斯·米奈希尔王子 B. 莱恩·乌瑞恩国王 C. 乌瑟尔·光明使者 !D. 泰瑞纳斯·米奈希尔二世国王
在撕心狼变成狼人之前，他也曾有过家室。他的妻子叫什么名字？ A. 艾玛·哈林顿 !B. 卡莉莎·哈林顿 C. 薇妮莎·怀特豪尔 D. 卡特里娜·怀特豪尔
有一位王后，在大灾变和被遗忘者袭击她的国度时，她井井有条地安排了人民的疏散工作。这位王后叫什么名字？ A. 莉亚·格雷迈恩王后 B. 玛利亚·格雷迈恩王后 C. 莉莉娅·格雷迈恩王后 !D. 米亚·格雷迈恩王后
在上古之战后，守护巨龙们给了暗夜精灵什么东西？ A. 泰达希尔 B. 永恒之井 !C. 诺达希尔 D. 月亮井
不久之前，一个脆弱的赞达拉巨魔想要驯服一头恐角龙。虽然他登上了巨兽岛，却在任务过程中遇害。请问这个巨魔叫什么名字？ A. 玛尔卡 B. 格里麦斯 !C. 塔拉克 D. 拉维里
瓦里安·乌瑞恩国王的第一任妻子的正确名字是什么？ A. 蒂芬·温德米尔·乌瑞恩 B. 泰丽丝·安妮·乌瑞恩 C. 泰丽丝·安哈蕾德·乌瑞恩 !D. 蒂芬·艾莉安·乌瑞恩
一位血色十字军保卫者在刺杀恐惧魔王贝塞利斯时遇害，她叫什么名字？ A. 菲尔拉蕾·迅箭 !B. 霍利亚·萨希尔德 C. 亚娜·血矛 D. 瓦雷亚
在担任家庭教师期间，斯塔文·密斯特曼托爱上了自己的学生，一个名叫蒂罗亚的年轻姑娘。请问她的弟弟叫什么名字？ A. 比利 B. 威廉姆 !C. 基尔斯 D. 托比亚斯
魅魔热衷于制造痛苦，她们在燃烧军团中专门负责进行可怕的拷问工作。请问魅魔属于哪个品种的恶魔？ A. 埃雷杜因 !B. 萨亚德 C. 破坏魔 D. 艾瑞达
铁炉堡图书馆中展出了一具巨型山羊的骨架复制品。这头传奇山羊叫什么名字？ A. 污蹄 !B. 磨齿 C. 血角 D. 钢拳
艾泽拉斯出现的第一个死亡骑士是谁？ !A. 塔隆·血魔 B. 阿尔萨斯·米奈希尔 C. 亚历山德罗斯·莫格莱尼 D. 库尔迪拉·织亡者
头衔中包含“夜晚之友”的是哪位神灵？ A. 西瓦尔拉 B. 吉布尔 !C. 缪萨拉 D. 沙德拉
德鲁伊的最高称号是什么？ A. 萨满祭司 B. 唤雷者 !C. 大德鲁伊 D. 先知
由玛法里奥·怒风协助建立的，艾泽拉斯最主要的德鲁伊组织叫什么名字？ A. 深红之环 B. 翡翠议会 C. 大地之环 !D. 塞纳里奥议会
在牛头人的语言中，lar'korwi是什么意思？ !A. 锋利的爪子 B. 剃刀般的牙齿 C. 锋利的牙齿 D. 剃刀般的爪子
侏儒如今的领袖是谁？ !A. 格尔宾·梅卡托克 B. 米尔豪斯·法力风暴 C. 希科·瑟玛普拉格 D. 菲兹兰克·铁阀
白狼曾是哪个兽人氏族最喜爱的坐骑？ A. 白爪氏族 B. 战歌氏族 !C. 霜狼氏族 D. 冰牙氏族
虚灵的家乡叫什么名字？ !A. 卡雷什 B. 夏罗迪 C. 库拉尔 D. 克索诺斯
嫌弃银月城过于明亮和干净的部落大使叫什么名字？ A. 科内塔 B. 克莉丝汀·德尼 !C. 塔泰 D. 德拉·符文图腾
由地精制造，原计划搭载萨尔和阿格娜前往大漩涡，却被联盟意外摧毁的部落舰船叫什么名字？ !A. 德拉卡的狂怒 B. 地狱咆哮的狂怒 C. 阿格娜的狂怒 D. 杜隆坦的狂怒
大领主库德兰·蛮锤最近痛失爱将，他英勇的狮鹫在一次大火中不幸丧生。这头狮鹫叫什么名字？ A. 迅捷之翼 B. 沙普比克 !C. 斯卡雷 D. 风暴比克
在第三次大战过去数年之后，黑暗之门重新开启时，艾泽拉斯首次出现了棕色皮肤的兽人。这些兽人被称为什么？ !A. 玛格汉兽人 B. 魔血兽人 C. 莫克纳萨兽人 D. 邪兽人
阿尔萨斯用来训练死亡骑士，后来又由于大部分死亡骑士背叛巫妖王而被占领的浮空堡垒叫什么名字？ !A. 阿彻鲁斯 B. 纳克萨纳尔 C. 科尔拉玛斯 D. 纳克萨玛斯
这个世界上的第一个萨特是谁？ A. 佩罗萨恩 B. 贾拉克萨斯 !C. 萨维斯 D. 维利塔恩
在突袭冰冠堡垒时，部落军队无耻地偷袭正与天灾军团激战的联盟士兵，并试图占领的那座城门叫什么名字？ A. 科雷萨 B. 奥尔杜萨 C. 安加萨 !D. 莫德雷萨
被洛肯捕获并变成锋鳞的强大始祖龙叫什么名字？ A. 迦拉克隆 !B. 维拉努斯 C. 塞普泰克 D. 维利塔恩
在最初的部落建立之前，有一种高传染性的病毒在兽人间快速传播。兽人们称这种病为什么？ A. 猩红热 B. 血色天灾 C. 血红热 !D. 红色天灾
在第三次大战期间，是什么证据使阿尔萨斯王子屠杀了斯坦索姆的居民？ A. 被污染的泥土 B. 被污染的野生动物 C. 被污染的水 !D. 被污染的粮食
赞加沼泽有一个地方，那里为纳迦所控制，他们还试图在那里抽取一种珍贵而稀有的资源：外域之水。这个地方叫什么名字？ A. 盘蛇洞穴 B. 蛇形盆地 !C. 盘牙水库 D. 旋牙水潭
提里奥·弗丁的灰色公马叫什么？ A. 阿什纳尔 B. 米瑟维尔 C. 菲奥尼尔 !D. 米拉多尔
在黑曜石圣殿守护暮光龙蛋的三头暮光幼龙分别叫什么？ !A. 塔尼布隆、维斯匹隆和沙德隆 B. 塔尼布隆、维斯匹隆和海里昂 C. 瑟纳利昂、沙德隆和艾比希昂 D. 瑟纳利昂、海里昂和艾比希昂
隶属于万神殿精锐的泰坦知识守护者叫什么名字？ A. 阿曼苏尔 !B. 诺甘农 C. 艾欧纳尔 D. 卡兹格罗斯
在被阿尔萨斯复活为亡灵，并加入天灾军团之前，辛达苟萨曾属于哪个巨龙军团？ A. 红龙军团 !B. 蓝龙军团 C. 绿龙军团 D. 青铜龙军团
根据德莱尼人的玩笑，“埃索达”在纳鲁语中是什么意思？ !A. 残次的雷象粪便 B. 水晶死亡陷阱 C. 毫无价值的雷象粪便 D. 放射性生化灾难
有一位德莱尼人，他曾是一个健康的圣骑士，但在与燃烧军团作战时，他身染恶疾，变成了破碎者。后来，他成了一个强大的萨满。这个德莱尼人是谁？ A. 维纶 B. 阿卡玛 C. 玛尔拉得 !D. 努波顿
]]

do
	local npcs={
		[110034] = true, --历史学家勒洛尔
		[110035] = true, --历史学家吉帕
		[73570] = true,  --资深历史学家伊夫琳娜
	};

	local pdata={}
	for k in string.gmatch(data,"(.-)\n") do
		table.insert(pdata,k)
	end
	local f=CreateFrame("frame")
	f:RegisterEvent("GOSSIP_SHOW")
	f:SetScript("OnEvent",function(self,event,...)
		local id = tonumber((UnitGUID("target") or ""):match(".-%-%d+%-%d+%-%d+%-%d+%-(%d+)"))
            if not npcs[id] then return end 
			local body=GossipGreetingText:GetText(C_GossipInfo.GetText())
			    if body=="答错了！" or body=="答对了！" or body=="这座岛真是既迷人又可怕。" or body=="没有历史，就没有未来。" then return end
			    local questbody=string.match(body,"那就让我们来测试一下你的历史知识吧！(.+)")
			    for _,v in pairs(pdata) do
				local match=string.match(v,questbody)
				if match then
				    local choose=string.match(v,"!(%a)")
					local choosebutton  
					if id == 110034 then
					    if (UnitFactionGroup("player") ~= "Horde") then 
						    if choose=="A"         then choosebutton=GossipFrame_GetTitleButton(3)
							    elseif choose=="B" then choosebutton=GossipFrame_GetTitleButton(4)
							    elseif choose=="C" then choosebutton=GossipFrame_GetTitleButton(5)
							    elseif choose=="D" then choosebutton=GossipFrame_GetTitleButton(6)
						    end
						else
						    if choose=="A"         then choosebutton=GossipFrame_GetTitleButton(1)
							    elseif choose=="B" then choosebutton=GossipFrame_GetTitleButton(2)
							    elseif choose=="C" then choosebutton=GossipFrame_GetTitleButton(3)
							    elseif choose=="D" then choosebutton=GossipFrame_GetTitleButton(4)
						    end
						end
					end
					if id == 110035 then
					    if (UnitFactionGroup("player") ~= "Horde") then 
						    if choose=="A"         then choosebutton=GossipFrame_GetTitleButton(1)
							    elseif choose=="B" then choosebutton=GossipFrame_GetTitleButton(2)
							    elseif choose=="C" then choosebutton=GossipFrame_GetTitleButton(3)
							    elseif choose=="D" then choosebutton=GossipFrame_GetTitleButton(4)
						    end
						else
						    if choose=="A"         then choosebutton=GossipFrame_GetTitleButton(3)
							    elseif choose=="B" then choosebutton=GossipFrame_GetTitleButton(4)
							    elseif choose=="C" then choosebutton=GossipFrame_GetTitleButton(5)
							    elseif choose=="D" then choosebutton=GossipFrame_GetTitleButton(6)
						    end	
                        end						
					end	
					if id == 73570 then
						if choose=="A"         then choosebutton=GossipFrame_GetTitleButton(2)
							elseif choose=="B" then choosebutton=GossipFrame_GetTitleButton(3)
							elseif choose=="C" then choosebutton=GossipFrame_GetTitleButton(4)
							elseif choose=="D" then choosebutton=GossipFrame_GetTitleButton(5)
						end
					end
				    choosebutton:SetText("\124cff4040ff"..choosebutton:GetText().."(选我)".."\124r")
				break
			end
		end
	end)
end
